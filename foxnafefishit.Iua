-- üêü Fish It ‚Ä¢ RNG Analyzer (Cast-Based)
-- by GPT-5 + Allexzzq

if not game:IsLoaded() then
	game.Loaded:Wait()
end

local Players = game:GetService("Players")
local lp = Players.LocalPlayer
local RunService = game:GetService("RunService")

-- ================= DATA =================
local MAX_CAST = 15
local CastCount = 0
local CastIntervals = {}

-- ================= UI LINK =================
local function updateUI(status, chance, cast, advice)
	if _G.FishItRNG_UI and _G.FishItRNG_UI.Update then
		_G.FishItRNG_UI.Update(status, chance, cast, advice)
	end
end

-- ================= ANALYSIS =================
local function analyze()
	if #CastIntervals < 5 then
		return "UNKNOWN", "?", "Mengumpulkan data..."
	end

	local variance = 0
	for i = 2, #CastIntervals do
		variance += math.abs(CastIntervals[i] - CastIntervals[i-1])
	end
	variance /= (#CastIntervals - 1)

	if variance < 0.4 then
		return "LOW", "RENDAH (relatif)", "Cast terlalu konsisten ‚Üí pindah pulau"
	elseif variance < 1 then
		return "MEDIUM", "SEDANG (relatif)", "RNG normal"
	else
		return "HIGH", "TINGGI (relatif)", "RNG hidup ‚Üí lanjut"
	end
end

-- ================= CAST DETECTION =================
-- Deteksi lempar pancing (universal)
lp.CharacterAdded:Connect(function(char)
	local toolConn
	char.ChildAdded:Connect(function(obj)
		if obj:IsA("Tool") then
			toolConn = obj.Activated:Connect(function()
				CastCount += 1
				table.insert(CastIntervals, os.clock())

				if #CastIntervals > MAX_CAST then
					table.remove(CastIntervals, 1)
				end

				local status, chance, advice = analyze()
				updateUI(status, chance, CastCount, advice)
			end)
		end
	end)
end)

-- INIT
updateUI("UNKNOWN", "?", 0, "RNG Analyzer aktif\nMulai casting...")
